
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../windows/CheckDisk/">
      
      
        <link rel="next" href="../../windows/CheckEventLog/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>CheckExternalScripts - NSClient++</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#checkexternalscripts" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="NSClient++" class="md-header__button md-logo" aria-label="NSClient++" data-md-component="logo">
      
  <img src="../../../../assets/nsclient-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NSClient++
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CheckExternalScripts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/mickem/nscp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    NSClient++
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../news/" class="md-tabs__link">
        
  
  
    
  
  News

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/mickem/nscp/releases" class="md-tabs__link">
        
  
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/mickem/nscp/discussions" class="md-tabs__link">
        
  
  
    
  
  Forums

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="NSClient++" class="md-nav__button md-logo" aria-label="NSClient++" data-md-component="logo">
      
  <img src="../../../../assets/nsclient-logo.png" alt="logo">

    </a>
    NSClient++
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mickem/nscp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    NSClient++
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../nsclient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About NSClient++
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../news/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    News
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/mickem/nscp/releases" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking Things
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing NSClient++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WEB UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../securing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Securing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Howto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Howto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking things
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/counters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Counters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/external_scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    External scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/run_commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/nrpe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NRPE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/nsca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NSCA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/03x_migration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migrate from 0.3
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_12_2" id="__nav_4_12_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Check commands
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_12_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_12_2">
            <span class="md-nav__icon md-icon"></span>
            Check commands
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/CheckDisk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckDisk (Windows)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CheckExternalScripts
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CheckExternalScripts
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-module" class="md-nav__link">
    <span class="md-ellipsis">
      Enable module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#samples" class="md-nav__link">
    <span class="md-ellipsis">
      Samples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Samples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-a-simple-script" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a simple script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Using arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-a-command-as-a-user" class="md-nav__link">
    <span class="md-ellipsis">
      Running a command as a user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programs-running-forever" class="md-nav__link">
    <span class="md-ellipsis">
      Programs "running forever"
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-script-settings" class="md-nav__link">
    <span class="md-ellipsis">
      External script settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External script settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#allow-arguments-when-executing-external-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Allow arguments when executing external scripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow-certain-potentially-dangerous-characters-in-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Allow certain potentially dangerous characters in arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-all-scripts-in-a-given-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Load all scripts in a given folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-root-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Script root folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Command timeout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-aliases" class="md-nav__link">
    <span class="md-ellipsis">
      Command aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      External scripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wrapped-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      Wrapped scripts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-wrappings" class="md-nav__link">
    <span class="md-ellipsis">
      Script wrappings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/CheckEventLog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckEventLog (Windows)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CheckHelpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckHelpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CheckLogFile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckLogFile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CheckMKClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckMKClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CheckMKServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckMKServer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/CheckNet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckNet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CheckNSCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckNSCP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unix/CheckSystemUnix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckSystemUnix (unix)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/CheckSystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckSystem (Windows)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/CheckTaskSched/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckTaskSched (Windows)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/CheckWMI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheckWMI (Windows)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12_3" >
        
          
          <label class="md-nav__link" for="__nav_4_12_3" id="__nav_4_12_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Clients & Servers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_12_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12_3">
            <span class="md-nav__icon md-icon"></span>
            Clients & Servers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/WEBServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WEBServer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/WEBClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WEBClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/NRPEServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NRPEServer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/NRPEClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NRPEClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/NSClientServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NSClientServer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/NSCAServer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NSCAServer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/NSCAClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NSCAClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/NRDPClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NRDPClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/SMTPClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SMTPClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/GraphiteClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GraphiteClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/SyslogClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SyslogClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/CollectdClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CollectdClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/Op5Client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Op5Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/ElasticClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ElasticClient
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12_4" >
        
          
          <label class="md-nav__link" for="__nav_4_12_4" id="__nav_4_12_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Helper modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_12_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12_4">
            <span class="md-nav__icon md-icon"></span>
            Helper modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/Scheduler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/SimpleFileWriter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SimpleFileWriter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/CommandClient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CommandClient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/SimpleCache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SimpleCache
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/PythonScript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PythonScript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../generic/LUAScript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LUAScript
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../extending/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Extending
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Extending
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extending/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../extending/zip-modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zip Modules
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../api/rest/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    REST
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14_1" id="__nav_4_14_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_14_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14_1">
            <span class="md-nav__icon md-icon"></span>
            REST
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Info
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Queries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/rest/legacy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Legacy API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugin API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/mickem/nscp/discussions" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forums
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="checkexternalscripts">CheckExternalScripts</h1>
<p>Module used to execute external scripts</p>
<h2 id="description">Description</h2>
<p><code>CheckExternalScripts</code> is used to run scripts and programs you provide your self as opposed to internal commands provided by modules and internal scripts. You can also find many third part generated scripts at various sites:</p>
<ul>
<li><a href="https://exchange.nagios.org/">Nagios Exchange</a></li>
<li><a href="https://exchange.icinga.com/">Icinga Exchange</a></li>
</ul>
<p>To use this module you need to enable it like so:</p>
<div class="highlight"><pre><span></span><code>nscp settings --activate-module CheckExternalScripts
</code></pre></div>
<p>Which will add the following to your configuration:</p>
<div class="highlight"><pre><span></span><code>[/modules]
CheckExternalScripts = enabled
</code></pre></div>
<p>There is an extensive guide on using external scripts with NSClient++ <a href="../../../howto/external_scripts/">here</a> as well as some examples in the <a href="#samples">samples section</a> of this page.</p>
<h2 id="enable-module">Enable module</h2>
<p>To enable this module and and allow using the commands you need to ass <code>CheckExternalScripts = enabled</code> to the <code>[/modules]</code> section in nsclient.ini:</p>
<div class="highlight"><pre><span></span><code>[/modules]
CheckExternalScripts = enabled
</code></pre></div>
<h2 id="samples">Samples</h2>
<p><em>Feel free to add more samples <a href="https://github.com/mickem/nscp/blob/master/docs/samples/CheckExternalScripts_samples.md">on this page</a></em></p>
<h3 id="adding-a-simple-script">Adding a simple script</h3>
<p>Adding a script we ca use the short hand format:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts/scripts]
my_ok1 = scripts\check_ok.bat
my_ok2 = scripts\check_ok.bat
</code></pre></div>
<p>Or the long format:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts/scripts/my_ok1]
command = scripts\check_ok.bat

[/settings/external scripts/scripts/my_ok2]
command = scripts\check_ok.bat
</code></pre></div>
<p>There is no difference between the two formats.
Both will add two new commands called my_ok1 and my_ok2 which in turn will execute the scripts\check_ok.bat script.
Thus for most cases the short hand is preferred (and most commonly used).
The reason for the long format is when you need to customize your command.
There are a number of options which can be set to customize the command: for instance which user should run the command.
These cannot be set using the short format.</p>
<h3 id="using-arguments">Using arguments</h3>
<p>There are two ways to use arguments.</p>
<ol>
<li>Hardcoded into the command</li>
<li>Allowing argument-pass through</li>
</ol>
<p>The first option (hard-coding them) is obviously the more secure option as a third party cannot provide his or her own arguments.
But it adds to the maintenance burden as whenever you want to change an option you need to update the NSClient++ configuration (something which can be costly if you have many servers).</p>
<p>To allow argument pass-through you need to set:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
allow arguments = true
</code></pre></div>
<p>Please note when it comes to arguments they can (and often need to) be configured in two place.
Once for the NRPE Server and once for <code>CheckExternalScripts</code>.</p>
<h3 id="running-a-command-as-a-user">Running a command as a user</h3>
<p>Running a command as a given user (to use elevated privileges for instance) you need to use the long format:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts/scripts/check_as_user]
command = scripts\check_ok.bat
user = Administrator
password = 1qflkasdhf7ejd8/kjhskjhk(/)&quot;#
</code></pre></div>
<p>You can also specify a session and to show the output if you want to have the program visible:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts/scripts/annoy_users]
command = notepad.exe
session = 1
display = true
</code></pre></div>
<h3 id="programs-running-forever">Programs "running forever"</h3>
<p>Another use case of external scripts is to have event handlers which starts programs.
This is trickier then it sounds because all commands have a timeout and once that is reach they are killed.
NSClient++ exits it also terminates all running script thus your "fix" will not be very long.</p>
<p>To work around this you need to start the program without the control of NSClient++ (fork). 
To do this you need to set capture output to false like so:</p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts/scripts/fix_problem]
command = notepad.exe
capture output = false
</code></pre></div>
<p>The draw back to this is that the script cannot return any output neither message nor status code.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>A word of warning using "start" or other similar measure to try to start a program in a regular script will cause a rather nasty unexpected issue with NSClient++ due to how handles are inherited in Windows.
Starting a background process in a script will end up blocking the port and forcing a restart of the server. 
Thus <code>capture output = false</code> method is preferred.</p>
</div>
<h2 id="configuration">Configuration</h2>
<table>
<thead>
<tr>
<th>Path / Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#external-script-settings">/settings/external scripts</a></td>
<td>External script settings</td>
</tr>
<tr>
<td><a href="#command-aliases">/settings/external scripts/alias</a></td>
<td>Command aliases</td>
</tr>
<tr>
<td><a href="#external-scripts">/settings/external scripts/scripts</a></td>
<td>External scripts</td>
</tr>
<tr>
<td><a href="#wrapped-scripts">/settings/external scripts/wrapped scripts</a></td>
<td>Wrapped scripts</td>
</tr>
<tr>
<td><a href="#script-wrappings">/settings/external scripts/wrappings</a></td>
<td>Script wrappings</td>
</tr>
</tbody>
</table>
<h3 id="external-script-settings">External script settings <a id="/settings/external scripts"/></h3>
<p>General settings for the external scripts module (CheckExternalScripts).</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#allow-arguments-when-executing-external-scripts">allow arguments</a></td>
<td>false</td>
<td>Allow arguments when executing external scripts</td>
</tr>
<tr>
<td><a href="#allow-certain-potentially-dangerous-characters-in-arguments">allow nasty characters</a></td>
<td>false</td>
<td>Allow certain potentially dangerous characters in arguments</td>
</tr>
<tr>
<td><a href="#load-all-scripts-in-a-given-folder">script path</a></td>
<td></td>
<td>Load all scripts in a given folder</td>
</tr>
<tr>
<td><a href="#script-root-folder">script root</a></td>
<td>${scripts}</td>
<td>Script root folder</td>
</tr>
<tr>
<td><a href="#command-timeout">timeout</a></td>
<td>60</td>
<td>Command timeout</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># General settings for the external scripts module (CheckExternalScripts).</span>
<span class="k">[/settings/external scripts]</span>
<span class="na">allow arguments</span><span class="o">=</span><span class="s">false</span>
<span class="na">allow nasty characters</span><span class="o">=</span><span class="s">false</span>
<span class="na">script root</span><span class="o">=</span><span class="s">${scripts}</span>
<span class="na">timeout</span><span class="o">=</span><span class="s">60</span>
</code></pre></div>
<h4 id="allow-arguments-when-executing-external-scripts">Allow arguments when executing external scripts <a id="/settings/external scripts/allow arguments"></a></h4>
<p>This option determines whether or not the we will allow clients to specify arguments to commands that are executed.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Path:</td>
<td><a href="#/settings/external scripts">/settings/external scripts</a></td>
</tr>
<tr>
<td>Key:</td>
<td>allow arguments</td>
</tr>
<tr>
<td>Default value:</td>
<td><code>false</code></td>
</tr>
<tr>
<td>Used by:</td>
<td>CheckExternalScripts</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
# Allow arguments when executing external scripts
allow arguments=false
</code></pre></div>
<h4 id="allow-certain-potentially-dangerous-characters-in-arguments">Allow certain potentially dangerous characters in arguments <a id="/settings/external scripts/allow nasty characters"></a></h4>
<p>This option determines whether or not the we will allow clients to specify nasty (as in |`&amp;&gt;&lt;'"\[]{}) characters in arguments.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Path:</td>
<td><a href="#/settings/external scripts">/settings/external scripts</a></td>
</tr>
<tr>
<td>Key:</td>
<td>allow nasty characters</td>
</tr>
<tr>
<td>Default value:</td>
<td><code>false</code></td>
</tr>
<tr>
<td>Used by:</td>
<td>CheckExternalScripts</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
# Allow certain potentially dangerous characters in arguments
allow nasty characters=false
</code></pre></div>
<h4 id="load-all-scripts-in-a-given-folder">Load all scripts in a given folder <a id="/settings/external scripts/script path"></a></h4>
<p>Load all scripts in a given directory and use them as commands.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Path:</td>
<td><a href="#/settings/external scripts">/settings/external scripts</a></td>
</tr>
<tr>
<td>Key:</td>
<td>script path</td>
</tr>
<tr>
<td>Default value:</td>
<td><em>N/A</em></td>
</tr>
<tr>
<td>Used by:</td>
<td>CheckExternalScripts</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
# Load all scripts in a given folder
script path=
</code></pre></div>
<h4 id="script-root-folder">Script root folder <a id="/settings/external scripts/script root"></a></h4>
<p>Root path where all scripts are contained (You can not upload/download scripts outside this folder).</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Path:</td>
<td><a href="#/settings/external scripts">/settings/external scripts</a></td>
</tr>
<tr>
<td>Key:</td>
<td>script root</td>
</tr>
<tr>
<td>Default value:</td>
<td><code>${scripts}</code></td>
</tr>
<tr>
<td>Used by:</td>
<td>CheckExternalScripts</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
# Script root folder
script root=${scripts}
</code></pre></div>
<h4 id="command-timeout">Command timeout <a id="/settings/external scripts/timeout"></a></h4>
<p>The maximum time in seconds that a command can execute. (if more then this execution will be aborted). NOTICE this only affects external commands not internal ones.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Path:</td>
<td><a href="#/settings/external scripts">/settings/external scripts</a></td>
</tr>
<tr>
<td>Key:</td>
<td>timeout</td>
</tr>
<tr>
<td>Default value:</td>
<td><code>60</code></td>
</tr>
<tr>
<td>Used by:</td>
<td>CheckExternalScripts</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code>[/settings/external scripts]
# Command timeout
timeout=60
</code></pre></div>
<h3 id="command-aliases">Command aliases <a id="/settings/external scripts/alias"/></h3>
<p>A list of aliases for already defined commands (with arguments).
An alias is an internal command that has been predefined to provide a single command without arguments. Be careful so you don't create loops (ie check_loop=check_a, check_a=check_loop)</p>
<p>This is a section of objects. This means that you will create objects below this point by adding sections which all look the same.</p>
<p><strong>Keys:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>alias</td>
<td></td>
<td>ALIAS</td>
</tr>
<tr>
<td>command</td>
<td></td>
<td>COMMAND</td>
</tr>
<tr>
<td>is template</td>
<td>false</td>
<td>IS TEMPLATE</td>
</tr>
<tr>
<td>parent</td>
<td>default</td>
<td>PARENT</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># An example of a Command aliases section</span>
<span class="k">[/settings/external scripts/alias/sample]</span>
<span class="c1">#alias=...</span>
<span class="c1">#command=...</span>
<span class="na">is template</span><span class="o">=</span><span class="s">false</span>
<span class="na">parent</span><span class="o">=</span><span class="s">default</span>
</code></pre></div>
<p><strong>Known instances:</strong></p>
<ul>
<li>alias_cpu</li>
<li>alias_cpu_ex</li>
<li>alias_disk</li>
<li>alias_disk_loose</li>
<li>alias_event_log</li>
<li>alias_file_age</li>
<li>alias_file_size</li>
<li>alias_mem</li>
<li>alias_process</li>
<li>alias_process_count</li>
<li>alias_process_hung</li>
<li>alias_process_stopped</li>
<li>alias_sched_all</li>
<li>alias_sched_long</li>
<li>alias_sched_task</li>
<li>alias_service</li>
<li>alias_service_ex</li>
<li>alias_up</li>
<li>alias_volumes</li>
<li>alias_volumes_loose</li>
</ul>
<h3 id="external-scripts">External scripts <a id="/settings/external scripts/scripts"/></h3>
<p>A list of scripts available to run from the CheckExternalScripts module. Syntax is: <code>command=script arguments</code></p>
<p>This is a section of objects. This means that you will create objects below this point by adding sections which all look the same.</p>
<p><strong>Keys:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>alias</td>
<td></td>
<td>ALIAS</td>
</tr>
<tr>
<td>capture output</td>
<td></td>
<td>CAPTURE OUTPUT</td>
</tr>
<tr>
<td>command</td>
<td></td>
<td>COMMAND</td>
</tr>
<tr>
<td>display</td>
<td></td>
<td>DISPLAY</td>
</tr>
<tr>
<td>domain</td>
<td></td>
<td>DOMAIN</td>
</tr>
<tr>
<td>encoding</td>
<td></td>
<td>ENCODING</td>
</tr>
<tr>
<td>ignore perfdata</td>
<td></td>
<td>IGNORE PERF DATA</td>
</tr>
<tr>
<td>is template</td>
<td>false</td>
<td>IS TEMPLATE</td>
</tr>
<tr>
<td>parent</td>
<td>default</td>
<td>PARENT</td>
</tr>
<tr>
<td>password</td>
<td></td>
<td>PASSWORD</td>
</tr>
<tr>
<td>session</td>
<td></td>
<td>SESSION</td>
</tr>
<tr>
<td>user</td>
<td></td>
<td>USER</td>
</tr>
</tbody>
</table>
<p><strong>Sample:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># An example of a External scripts section</span>
<span class="k">[/settings/external scripts/scripts/sample]</span>
<span class="c1">#alias=...</span>
<span class="c1">#capture output=...</span>
<span class="c1">#command=...</span>
<span class="c1">#display=...</span>
<span class="c1">#domain=...</span>
<span class="c1">#encoding=...</span>
<span class="c1">#ignore perfdata=...</span>
<span class="na">is template</span><span class="o">=</span><span class="s">false</span>
<span class="na">parent</span><span class="o">=</span><span class="s">default</span>
<span class="c1">#password=...</span>
<span class="c1">#session=...</span>
<span class="c1">#user=...</span>
</code></pre></div>
<h3 id="wrapped-scripts">Wrapped scripts <a id="/settings/external scripts/wrapped scripts"/></h3>
<p>A list of wrapped scripts (ie. script using a template mechanism).
The template used will be defined by the extension of the script. Thus a foo.ps1 will use the ps1 wrapping from the wrappings section.</p>
<p>This is a section of objects. This means that you will create objects below this point by adding sections which all look the same.</p>
<h3 id="script-wrappings">Script wrappings <a id="/settings/external scripts/wrappings"/></h3>
<p>A list of templates for defining script commands.
Enter any command line here and they will be expanded by scripts placed under the wrapped scripts section. %SCRIPT% will be replaced by the actual script an %ARGS% will be replaced by any given arguments.</p>
<p>This is a section of objects. This means that you will create objects below this point by adding sections which all look the same.</p>
<p><strong>Known instances:</strong></p>
<ul>
<li>bat</li>
<li>ps1</li>
<li>vbs</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "toc.follow", "toc.integrate", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>